Generate executive project newsletters from Azure DevOps work item hierarchies.

## Trigger
User requests: "newsletter", "initiative update", "executive summary", "status update" + work item ID

## ⚠️ CRITICAL: Use the GenerateNewsletter Capability (NO EXCEPTIONS)

**MANDATORY:** Newsletter generation is now a dedicated capability that handles data retrieval and synthesis with an optimized model (gpt-4o).

**DO NOT manually call GetWorkItemTree and synthesize the newsletter yourself.**
**ALWAYS use the GenerateNewsletter capability which does this for you.**

**NEVER SKIP the tool call** - Even if the work item ID looks unusual or you think it might not exist, call GenerateNewsletter anyway. Let the tool determine if the work item exists. Never respond with "I encountered an issue" or "Please verify" without first calling the tool.

## Process

**1. Extract Work Item ID**
Parse user input for work item ID (epic/feature).

If missing: "Please provide the Azure DevOps work item ID (epic or feature) for the newsletter."

**2. Call GenerateNewsletter Capability**

**ALWAYS** call the GenerateNewsletter capability:

```
AzureDevOpsTool.Execute("GenerateNewsletter", {"workItemId": <id>})
```

Optional parameters:
- `format`: Newsletter style ("Executive" [default], "Technical", "Brief")
- `depth`: Hierarchy depth to analyze (default: 3)

**Example calls:**
```json
// Default executive format
{"workItemId": 123456}

// Brief format
{"workItemId": 123456, "format": "Brief"}

// Custom depth
{"workItemId": 123456, "depth": 5}
```

**IMPORTANT:** Do not assume a work item doesn't exist based on the ID format. Always call the tool and let Azure DevOps determine if the item exists. If the tool returns an error, inform the user that the work item was not found.

**3. Return the Newsletter**

The GenerateNewsletter capability returns a JSON response containing the formatted newsletter:

```json
{
  "workItemId": 123456,
  "format": "Executive",
  "newsletter": "[Markdown-formatted newsletter content]",
  "generatedAt": "2026-02-01T12:00:00Z"
}
```

Extract the `newsletter` field and present it to the user as-is. Do NOT modify or reformat the generated newsletter.

## Newsletter Format (Handled by Capability)

The GenerateNewsletter capability automatically produces newsletters with these sections:

1. **Overview** - Project scope and current status summary
2. **Execution Timelines & Milestones** - Key dates and milestone status
3. **Outcomes Since Last Newsletter** - Recently completed work and achievements
4. **Current Sprint Progress** - Active work items and completion percentage
5. **Risks & Mitigation Plan** - Identified risks with impact assessment
6. **Recommendations** - Suggested actions for stakeholders (if applicable)

The capability uses:
- Professional, executive-friendly language
- Work item IDs as citations for traceability
- Markdown formatting for readability
- Business outcome focus over technical details (unless "Technical" format requested)

## Error Handling

If the GenerateNewsletter capability fails:
- Check if the work item ID is valid
- Verify the work item is a Feature or Epic (newsletters work best for these types)
- Ensure the work item has sufficient data (children, dates, descriptions)

If error persists: "I encountered an issue generating the newsletter for work item {id}. Please verify the work item exists and has child items."

## Performance Note

Newsletter generation uses the gpt-4o model for high-quality synthesis and typically completes in 10-15 seconds. The user will see a "Generating newsletter..." progress indicator while the capability executes.
