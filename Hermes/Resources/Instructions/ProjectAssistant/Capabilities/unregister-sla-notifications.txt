Remove user from daily SLA violation notification list.

## Trigger
User requests: "unregister from SLA", "stop SLA notifications", "disable SLA alerts", "I don't want SLA reports", "turn off SLA notifications"

## ⚠️ CRITICAL: Parameter Extraction

**YOU MUST extract teamsUserId from the system message BEFORE calling the tool.**

The system message will contain (look for "User Context Override"):
```
## User Context Override
Current user: visomasu@microsoft.com (Teams User ID for tool calls)
```

**YOUR TOOL CALL MUST LOOK LIKE THIS:**
```json
{
  "teamsUserId": "visomasu@microsoft.com"
}
```

**CORRECT EXAMPLES:**
- System says "Current user: alice@contoso.com" → Use: `{"teamsUserId": "alice@contoso.com"}`
- System says "Current user: bob@fabrikam.com" → Use: `{"teamsUserId": "bob@fabrikam.com"}`

**WRONG - DO NOT DO THIS:**
- ❌ `{"teamsUserId": ""}` - Empty string
- ❌ `{"teamsUserId": "<userId>"}` - Placeholder text
- ❌ `{}` - Missing teamsUserId field entirely

If you cannot find the user ID in system messages, return an error message with the exact format expected.

---

## Process

**1. Identify User Intent**
Parse user input for unregistration keywords. Confirm intent if ambiguous to avoid accidental unregistration.

**2. Execute Unregistration**

Call the tool with the extracted teamsUserId:
```
UserManagementTool.Execute("UnregisterSlaNotifications", {"teamsUserId": "<actual-user-id-from-system-message>"})
```

This automatically:
- Checks if user is currently registered
- Sets IsRegistered flag to false in UserConfiguration
- Disables SlaViolationNotifications preference
- Preserves historical registration data (for re-registration)

**3. Communicate Result**

**⚠️ CRITICAL: Success Response Format**

When the tool call succeeds, use ONLY one of these formats:

**If user was registered:**
```
✅ You've been successfully unregistered from SLA notifications.

You will no longer receive daily SLA reports.
```

**If user was not registered:**
```
You are not currently registered for SLA notifications.
```

**ABSOLUTELY FORBIDDEN in success responses:**
- ❌ DO NOT mention "error", "failed", "failure", "issue", "problem"
- ❌ DO NOT include troubleshooting steps
- ❌ DO NOT say "contact support" or "try again"
- ❌ DO NOT explain what could go wrong

**If the tool succeeds, ONLY provide the positive confirmation above. Nothing else.**

## Important Notes

**What Stops:**
- Daily scheduled SLA violation digest emails
- Automatic team aggregation (for managers)

**What Still Works:**
- On-demand SLA checks via "check my SLA violations" command
- User can re-register at any time with no data loss
- Manager's direct reports are unaffected (they still receive their own notifications if registered)

**Silent Operation:**
- Direct reports are not notified when manager unregisters
- No audit trail or notification to team members

## Re-registration

Users can re-register at any time using the RegisterSlaNotifications capability. The system will:
- Re-fetch current direct reports from Microsoft Graph
- Update stored profile with latest organizational data
- Resume daily notifications immediately

## Related Capabilities

- **RegisterSlaNotifications:** Re-enable daily SLA notifications
- **CheckSlaViolations:** Perform immediate one-time SLA check (works without registration)

## Error Handling

**⚠️ CRITICAL: ONLY use error messages if the tool call ACTUALLY FAILS**

**When to use error responses:**
- Tool returns an exception or error object
- Tool response explicitly indicates failure

**Error message templates (ONLY if tool fails):**

If unregistration fails:
"An error occurred during unregistration. Please try again later."

If user data cannot be accessed:
"Could not access your registration data. Please contact support."

**⚠️ REPEAT: Do NOT use these error messages if the tool call succeeds!**
